<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <link rel="stylesheet" href="../adminitems/adminitems.css">
    <title>Admin Dashboard</title>
</head>

<body>

    <div class="container">
        <!-- Sidebar Section -->
        <aside>
            <div class="toggle">
                <div class="logo">
                    <h2>Ad<span class="danger">Min</span></h2>
                </div>
                <div class="close" id="close-btn">
                    <span class="material-icons-sharp">
                        close
                    </span>
                </div>
            </div>

            <div class="sidebar">
                <a href="../../admin/admin.html" target="_top">
                    <span class="material-icons-sharp">
                        dashboard
                    </span>
                    <h3>Dashboard</h3>
                </a>
                <a href="../adminorders/adminorders.html">
                    <span class="material-icons-sharp">
                        format_list_numbered_rtl
                    </span>
                    <h3>Orders</h3>
                </a>
                <a href="../adminitems/adminitems.html"  class="active">
                    <span class="material-icons-sharp">
                        category
                    </span>
                    <h3>Items</h3>
                </a>
                <a href="#">
                    <span class="material-icons-sharp">
                        insights
                    </span>
                    <h3>Analytics</h3>
                </a>
                <a href="#">
                    <span class="material-icons-sharp">
                        receipt_long
                    </span>
                    <h3>Reports</h3>
                </a>
                <a href="#">
                    <span class="material-icons-sharp">
                        settings
                    </span>
                    <h3>Settings</h3>
                </a>
                <a href="../../../Index.html">
                    <span class="material-icons-sharp">
                        logout
                    </span>
                    <h3>Logout</h3>
                </a>
            </div>
        </aside>
        <!-- End of Sidebar Section -->

        <!-- Main Content -->
        <main>
            
            <!-- End of Analyses -->

             <!-- New items Section  -->
            <div class="new-items">
                <h2>Categories and Items</h2>
                <div class="item-list">
                    <div class="item">
                        <img src="../images/category.png">
                        <h2>Categories</h2>
                        <p>7</p>
                    </div>
                    <div class="item">
                        <img src="../images/items.png">
                        <h2>Items</h2>
                        <p>54</p>
                    </div>
                    <div class="item">
                        <img src="../images/plus.png">
                        <h2>Add New</h2>
                        <p>Item or Category</p>
                    </div>
                </div>
            </div>
             <!-- End of New items Section -->
            <!-- Recent Orders Table  -->
            <section class="current-items">
                <h2>Current Items</h2>
                <table id="current-items">
                    <thead>
                        <tr>
                            <th>item Id</th>
                            <th>Item Name</th>
                            <th>Category Id</th>
                            <th>Price</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <a href="#">Show All</a>
            </section>
            <!-- End of Recent Orders -->
            <!-- Recent Orders Table  -->
            <section class="current-category">
                <h2>Current Categories</h2>
                <table id="current-category"> 
                    <thead>
                        <tr id="cat">
                            <th>Category Id</th>
                            <th>Category Name</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <a href="#">Show All</a>
            </section>
            <!-- End of Recent Orders -->

            <!-- Add New Item -->
            <div class="new-products">
                <h2>Add Category</h2>
                <div class="product-details" id="catpd">
                    <div class="product" id="catRequired">
                        <h2> You must enter a value in Input Field</h2>
                    </div>
                    <div class="product">
                        <h1> Category Name </h1>
                        <input type="text" id="inField" class="category-input" placeholder=" Enter Name">
                    </div>
                    <div class="product" id="catSuccess">
                        <h2> Category Created Successfully !</h2>
                    </div>
                    <div class="product">
                        <div class="btn-container">
                            <button class="btn" onclick="create_category()"> Add</button>
                            <button class="btn"> Cancel</button>   
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="new-products" id="new-product-items">
                <h2>Add Items</h2>
                <div class="product-details">
                    <div class="product">
                        <h1> Item Name </h1>
                        <input type="text" class="category-input" placeholder=" Enter Name">
                    </div>
                    <div class="product">
                        <h1> Price: Â£ </h1>
                        <input type="text" placeholder=" Enter Price">
                    </div>
                    <div class="product">
                        <h1 > Category: </h1>
                        <select class="category-selector" name="category" id="categorySelector">
                        </select>
                    </div>
                    <div class="product" >
                        <h1 > Type: </h1>
                        <select class="category-selector" name = "type">
                            <option value="no" selected>N/A</option>
                            <option value="yes" >Yes</option>
                        </select>
                    </div>
                    <div class="product">
                        <div class="btn-container">
                            <button class="btn" onclick="create_category()"> Submit</button>
                            <button class="btn"> Cancel</button>   
                        </div>
                    </div>
                </div>
                
            </div>
        </main>
        <!-- End of Main Content -->
        <!-- Right Section -->
        <div class="right-section">
            <div class="nav">
                <button id="menu-btn">
                    <span class="material-icons-sharp">
                        menu
                    </span>
                </button>
                <div class="dark-mode">
                    <span class="material-icons-sharp active">
                        light_mode
                    </span>
                    <span class="material-icons-sharp">
                        dark_mode
                    </span>
                </div>

            </div>
            <!-- End of Nav -->
        </div>
    </div>
    <div id="editModal" class="editmodal"></div>
    <div id="deleteModal" class="deletemodal"></div>

    <script type="module" src="../data.js"></script>
    <script type="module" src="../functions.js"></script>
    <script type="module" src="../adminmain.js"></script>
    <script>
    
    function create_category() {
        const categoryNameInput = document.querySelector('.product input');
        const enteredCategoryName = categoryNameInput.value;

        if (enteredCategoryName.trim() !== '') {
            // Only proceed if the input has a non-empty value

            newCategoryName = enteredCategoryName;
            const data = {
                categoryname: enteredCategoryName
            };

            window.parent.postMessage(data, '*');

            fetch('http://127.0.0.1:5000/add_category', {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.text();
            })
            .then(data => {
                const sucMsg = document.getElementById('catSuccess');
                sucMsg.style.display = 'block';
                const inField = document.getElementById('inField');
                inField.value = ""; // Clear the input field
                console.log('Success:', data);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        } else {
            // Alert the user or handle the case when the input is empty
            const errMsg = document.getElementById('catRequired');
            errMsg.style.display = 'block';
        }
    }        
    </script>
</body>

</html>